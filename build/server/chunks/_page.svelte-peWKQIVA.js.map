{"version":3,"file":"_page.svelte-peWKQIVA.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/login/_page.svelte.js"],"sourcesContent":["import { c as create_ssr_component, v as validate_component, d as add_attribute } from \"../../../chunks/ssr.js\";\n/* empty css                                                  */\nimport { a as ajaxPost, F as FormElm, B as BtnWIconSm } from \"../../../chunks/FormElm.js\";\nimport { t as toast } from \"../../../chunks/SvelteToast.svelte_svelte_type_style_lang.js\";\nimport { g as goto } from \"../../../chunks/client.js\";\nimport { I as Icons } from \"../../../chunks/Logo.js\";\nimport { H as HdgWithIcon } from \"../../../chunks/HdgWithIcon.js\";\nimport { P as PageWrapper } from \"../../../chunks/PageWrapper.js\";\nimport { A as API_URL } from \"../../../chunks/config.js\";\nimport { N as Nav } from \"../../../chunks/Nav.js\";\nfunction validateString(str, min, max) {\n  let errors = [];\n  if (str.length < min) {\n    errors.push(`The string length must be at least ${min} characters.`);\n  }\n  if (str.length > max) {\n    errors.push(`The string length must be at most ${max} characters.`);\n  }\n  if (errors.length > 0) {\n    return {\n      status: \"error\",\n      errors\n    };\n  }\n  return {\n    status: \"ok\"\n  };\n}\nfunction validateEmail(email) {\n  const errors = [];\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  if (!emailRegex.test(email)) {\n    errors.push(\"Email address is invalid\");\n  }\n  if (email.indexOf(\"@\") === -1) {\n    errors.push(\"Email address must contain @ symbol\");\n  }\n  const domain = email.split(\"@\")[1];\n  if (!domain) {\n    errors.push(\"Email address must contain domain name\");\n  }\n  const domainRegex = /^[^\\s@]+\\.[^\\s@]+$/;\n  if (!domainRegex.test(domain)) {\n    errors.push(\"Domain name is invalid\");\n  }\n  if (errors.length > 0) {\n    return { status: \"error\", errors };\n  } else {\n    return { status: \"ok\" };\n  }\n}\nasync function loginFn(email, password) {\n  try {\n    debugger;\n    const emailError = validateEmail(email);\n    if (emailError.status !== \"ok\") {\n      toast.push(\"Not a valid email\");\n      return;\n    }\n    const passwordError = validateString(password, 6, 30);\n    if (passwordError.status !== \"ok\") {\n      toast.push(\"password must have 6 to 30 characters\");\n      return;\n    }\n    const response = await ajaxPost(`${API_URL}/auth/login`, { email, password });\n    debugger;\n    if (response.ok) {\n      const data = await response.json();\n      localStorage.setItem(\"token\", data.token);\n      localStorage.setItem(\"email\", data.email);\n      goto(\"/\");\n    } else {\n      const data = await response.json();\n      if (data.errorcode == \"AccountNotVerified\") {\n        goto(\"/verify\");\n      }\n      toast.push(data.message);\n    }\n  } catch (err) {\n    toast.push(\"failed to login\");\n  }\n}\nconst Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let email = \"\";\n  let password = \"\";\n  return `${validate_component(Nav, \"Nav\").$$render($$result, {}, {}, {})} ${validate_component(PageWrapper, \"PageWrapper\").$$render($$result, {}, {}, {\n    default: () => {\n      return `<br><br> <div class=\"flex justify-center w-full\"><div class=\"w-10/12 \">${validate_component(FormElm, \"FormElm\").$$render($$result, {}, {}, {\n        default: () => {\n          return `<div class=\"flex justify-center\">${validate_component(HdgWithIcon, \"HdgWithIcon\").$$render($$result, { icon: Icons.KEY }, {}, {\n            default: () => {\n              return `Login`;\n            }\n          })}</div> <div class=\"flex justify-center pt-1 text-white\" data-svelte-h=\"svelte-klynmt\">Email</div> <div class=\"flex justify-center pt-1\"><div class=\"w-6/12 text-center\"><input type=\"email\" class=\"w-full bg-gray-700 color-white p-2 m-1 rounded-md\"${add_attribute(\"value\", email, 0)}></div></div> <div class=\"flex justify-center pt-1 text-white\" data-svelte-h=\"svelte-1by2qsq\">Password</div> <div class=\"flex justify-center pt-1\"><div class=\"w-6/12 text-center\"><input type=\"password\" class=\"w-full bg-gray-700 color-white p-2 m-1 rounded-md\"${add_attribute(\"value\", password, 0)}></div></div> <div class=\"flex justify-center\" data-svelte-h=\"svelte-1h7bq5\"><a href=\"/forgot_password\" class=\"text-yellow-700 text-lg\">forgot password</a></div> <div class=\"flex justify-center \">${validate_component(BtnWIconSm, \"BtnWIconSm\").$$render(\n            $$result,\n            {\n              icons: Icons.SAVE,\n              clk: () => loginFn(email, password)\n            },\n            {},\n            {\n              default: () => {\n                return `Login`;\n              }\n            }\n          )}</div>`;\n        }\n      })}</div></div>`;\n    }\n  })}`;\n});\nexport {\n  Page as default\n};\n"],"names":[],"mappings":"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"}